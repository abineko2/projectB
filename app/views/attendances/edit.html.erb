<%=provide(:title,"勤怠編集") %>

<div style="text-align:center;padding-bottom:10px;">
    <h1>勤怠編集</h1>
</div>
<%=form_for(@user,url:update_attendances_path,method: :patch) do |f| %>
<table class="table table-bordered table-condensed table-striped ">
        <thead>
            <tr>
                <th rowspan="2">日付</th>
                <th rowspan="2">曜日</th>
                <th rowspan="2">出勤時間</th>
                <th rowspan="2">退勤時間</th>
                <th rowspan="2">在社時間</th>
                <th rowspan="2">備考</th>
            </tr>
        </thead>
        <tbody>
            <% @dates.each do |day| %>
              <%=fields_for "attendances[]",day do |af| %>
              <tr>
                  <td><%=day.worked_on.to_s(:date) %></td>
                  <td><%=%w(日 月 火 水 木 金 土)[day.worked_on.wday] %></td>
                  <td><%=af.time_field :start_at,class:"form-control" %></td>
                  <td><%=af.time_field :finished_at,class:"form-control" %></td>
                  <td>
                      <% if day.start_at.present? && day.finished_at.present? %>
                        <%=working_time(day.finished_at,day.start_at) %>
                      <% end %>
                  </td>
                  <td><%=af.text_field :note %></td>
              </tr>
              <% end %>
            <% end %>
        </tbody>
    </table>
    <div class="button_field">
        <ul>
            <li><%=link_to "キャンセル",user_path(@user,params:{first_day:@first_day}),class:"btn btn-default" %></li>
            <li><%=f.submit "編集を保存する",class:"btn btn-primary" %></li>
        </ul>
    </div>
    <% end %>
</div>
